{% extends "base.html" %}
{% load i18n %}

{% block title %}
  {% if node %}
    {% if not node.title and node.has_parent %}
      <a href="{{ node.get_parent.permalink }}">{{ node.get_parent.title }}</a>
    {% else %}
      {{ node.title }}
    {% endif %}
  {% else %}
    {% trans "All nodes" %}
  {% endif %}
{% endblock %}

{% block content %}
  <div class="row">
    <ul class="nav nav-pills pull-right">
      <li><a href="{% url node_update node.get_id %}">{% trans "Edit" %}</a></li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
          {% trans "Convert to" %}
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          {% for link, label in view.get_convert_to_links %}
          <li><a href="{{ link }}">{{ label }}</a></li>
          {% endfor %}
        </ul>
      </li>
    </ul>
  </div>

  {% block node_body %}
  {{ node.render_body }}
  {% endblock %}
  
  <div>
    {% for tag in node.tags %}
    <a href="{% url node_details tag %}"><i class="icon-tag"></i>{{ tag }}</a>
    {% endfor %}
  </div>
  
  <hr />
  
  <h2>{% trans "Add tag" %}</h2>
  
  <form action="{{ node.tag_url }}" method="post">
    {% csrf_token %}
    <p>{{ tag_form.tag.errors }}{{ tag_form.tag }}</p>
    <p><button type="submit" class="btn btn-primary">{% trans "Save" %}</button></p>
  </form>
  
  <hr />
  
  <h2>{% trans "Create new comment" %}</h2>
  
  <form method="post">
    {% csrf_token %}
    <p>{{ comment_form.body }}</p>
    <p><input type="submit" value="{% trans "Save" %}" /></p>
  </form>
{% endblock %}
